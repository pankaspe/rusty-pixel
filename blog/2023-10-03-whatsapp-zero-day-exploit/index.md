---
title: WhatsApp Zero-Day Exploit
description: Scopri il rischio degli Zero-Day Exploit su WhatsApp. Proteggiti dalle minacce cibernetiche con consigli aggiornati sulla sicurezza digitale.
tags: [exploit, applicazioni-mobile, buffer-overflow]
image: ./img/social-card.png
---

![WhatsApp Zero-Day Exploit](./img/social-card.png)

# Zero-Day Exploit
Questo particolare **exploit** di sicurezza, comunemente chiamato **WhatsApp Zero-Day Exploit**, è stato scoperto nel *2019* e permetteva agli attaccanti di installare *spyware* sui telefoni cellulari degli utenti semplicemente facendo una chiamata tramite *WhatsApp*.
<!--truncate-->
Una volta installato, questo *spyware* poteva monitorare le attività degli utenti, inclusi messaggi, chiamate, e-mail e altro, mettendo a rischio la privacy degli utenti. È stato segnalato che gli attaccanti hanno sfruttato questa vulnerabilità per spiare giornalisti, attivisti e altre persone di interesse.

**WhatsApp** ha **risolto** la vulnerabilità rilasciando patch di sicurezza per i suoi utenti. Tuttavia, questo episodio ha sottolineato l'importanza di **mantenere costantemente aggiornate le applicazioni** e i dispositivi per proteggersi da *exploit* di sicurezza noti e sconosciuti.

:::info
**Zero-day exploit** indica un'attività malevola che sfrutta una vulnerabilità appena scoperta nel software. Il termine "zero day" deriva dal fatto che gli sviluppatori non hanno ancora avuto alcun giorno (zero giorni) per risolvere il problema prima che venga abusato da hacker o malware.
:::

## Come funzionava?
L'exploit di WhatsApp, sfruttava una vulnerabilità nel *protocollo di chiamata* di WhatsApp. Gli attaccanti inviavano chiamate tramite WhatsApp ai telefoni cellulari delle vittime, anche se queste ultime non rispondevano alle chiamate. Ciò permetteva loro di installare spyware (un tipo di software malevolo che spia l'utente senza il suo consenso) sui dispositivi delle vittime.

Il processo funzionava più o meno così:

1. **Chiamata ingresso:** L'attaccante inviava una chiamata tramite WhatsApp al numero di telefono della vittima. La vittima non doveva rispondere alla chiamata affinché l'exploit funzionasse.
2. **Vulnerabilità sfruttata:** Durante il processo di ricezione della chiamata, un bug nel protocollo di WhatsApp veniva sfruttato. Questo bug consentiva agli attaccanti di inviare pacchetti di dati dannosi durante l'inizializzazione della chiamata, senza che l'utente rispondesse o accettasse la chiamata.
3. **Installazione di spyware:** Gli attaccanti utilizzavano questa vulnerabilità per installare spyware sul dispositivo della vittima. Questo spyware poteva accedere a varie funzioni del telefono, come messaggi, chiamate, fotocamera, microfono e altro ancora, consentendo agli attaccanti di monitorare le attività dell'utente senza il suo consenso.
4. **Rimozione delle tracce:** Dopo l'installazione riuscita dello spyware, gli attaccanti cancellavano le tracce dell'attività, rendendo difficile per la vittima rilevare la presenza del software malevolo.

Questo exploit ha permesso agli attaccanti di spiare utenti di WhatsApp selezionati, inclusi giornalisti, attivisti e altre persone di interesse. WhatsApp ha affrontato rapidamente la vulnerabilità **rilasciando patch di sicurezza** per proteggere gli utenti dall'exploit e ha incoraggiato tutti gli utenti a mantenere l'applicazione aggiornata per proteggersi da eventuali minacce di sicurezza.

## Quale bug sfruttava ?
Il bug specifico che è stato sfruttato nell'**exploit** di WhatsApp non è stato completamente dettagliato pubblicamente per proteggere la sicurezza degli utenti. Le informazioni dettagliate sul bug esatto e su come è stato sfruttato non sono state divulgate pubblicamente dalle autorità o dalla società madre di WhatsApp, Facebook, per evitare che altre persone tentino di riprodurre l'attacco.

Tuttavia, è stato confermato che il bug consentiva agli attaccanti di inviare pacchetti di dati dannosi durante l'inizializzazione di una chiamata WhatsApp, anche se l'utente non rispondeva alla chiamata. Questo ha permesso agli attaccanti di installare spyware sul dispositivo della vittima senza il suo consenso, aprendo la porta a potenziali attività di spionaggio.

WhatsApp ha **prontamente risolto questa vulnerabilità** rilasciando patch di sicurezza per proteggere gli utenti dall'exploit e ha incoraggiato tutti gli utenti a mantenere l'applicazione aggiornata per proteggersi da eventuali minacce di sicurezza simili.

## Come proteggersi dagli exploit?
Mantenere il software **aggiornato** è **cruciale** per garantire la sicurezza e l'efficienza dei sistemi informatici. Le nuove versioni di software spesso includono correzioni di sicurezza per vulnerabilità note e miglioramenti alle prestazioni. **Ignorare gli aggiornamenti mette a rischio i dispositivi e le applicazioni**, poiché le vulnerabilità non corrette possono essere sfruttate da malintenzionati.

Inoltre, gli aggiornamenti spesso introducono nuove funzionalità e miglioramenti all'usabilità, migliorando l'esperienza degli utenti. I software obsoleti potrebbero non essere compatibili con le ultime tecnologie, limitando l'accesso a nuove funzionalità e servizi.  
Mantenere il software aggiornato è quindi essenziale per proteggere la sicurezza dei dati, garantire la stabilità del sistema e sfruttare appieno le potenzialità delle moderne tecnologie informatiche. Inoltre, gli aggiornamenti sono una pratica fondamentale per mantenere la sicurezza cibernetica e proteggere le reti da minacce in continua evoluzione.

## Ipotesi 
Un'**ipotesi** possibile è che il bug potesse riguardare un difetto nel processo di gestione delle chiamate in arrivo da parte di WhatsApp. Gli attaccanti potrebbero aver scoperto un modo per inviare dati malevoli insieme a una chiamata in arrivo, sfruttando un **errore nel protocollo di comunicazione** della chiamata.

Ad esempio, durante l'inizializzazione di una chiamata in arrivo, WhatsApp potrebbe essere vulnerabile a un attacco di tipo **buffer overflow**, dove gli attaccanti inseriscono dati dannosi più lunghi del previsto, sovrascrivendo parti della memoria del dispositivo e consentendo l'esecuzione di codice malevolo.

In un contesto di sicurezza, spesso gli attaccanti cercano di sfruttare **errori di programmazione** come questo per ottenere l'esecuzione del loro codice arbitrario. In questo caso, potrebbero aver utilizzato questa *vulnerabilità* per installare e eseguire uno *spyware* nel dispositivo della vittima, senza richiedere alcuna azione da parte dell'utente oltre a ricevere la chiamata.

:::caution
Questa è solo un'ipotesi generica basata sulla natura comune degli exploit di sicurezza. Poiché i dettagli esatti del bug non sono stati resi pubblici, questa spiegazione potrebbe non corrispondere esattamente alla natura precisa dell'exploit di WhatsApp in questione.
:::

## Dettagli nerd

### Il buffer overflow
Il **buffer overflow** è una vulnerabilità di sicurezza informatica che si verifica quando un programma, durante l'esecuzione, scrive dati in una zona di memoria temporanea, chiamata "buffer", ma sovrascrive accidentalmente aree di memoria adiacenti. Questo può causare il malfunzionamento del programma o, peggio ancora, consentire a un attaccante di inserire codice malevolo nel buffer. Quando il **buffer overflow** si verifica, il codice aggiunto dall'attaccante viene eseguito, consentendogli di prendere il controllo del programma o persino del sistema. 

Questo tipo di attacco è spesso sfruttato per eseguire codice dannoso e ottenere accesso non autorizzato a sistemi informatici. Le tecniche per prevenire il **buffer overflow** includono la **validazione accurata dei dati** in ingresso, l'uso di **linguaggi di programmazione sicuri** che gestiscono automaticamente i limiti del buffer e l'implementazione di protezioni hardware e software, come la *randomizzazione degli indirizzi di memoria*, per rendere più difficile l'esecuzione di attacchi di overflow.

### Codice vulnerabile
:::danger
Un esempio concettuale di come un bug di buffer overflow potrebbe verificarsi in un linguaggio non sicuro. Supponiamo di avere un array di caratteri (buffer) e di voler copiare una stringa più lunga del buffer in questo modo:

```c
#include <string.h>
#include <stdio.h>

int main() {
    char buffer[5];  // Dichiarazione di un buffer di 5 caratteri
    char input[10];  // Stringa di input di 10 caratteri

    printf("Inserisci una stringa: ");
    gets(input);  // Attenzione: gets() non verifica la lunghezza dell'input

    strcpy(buffer, input);  // Copia l'input nel buffer

    printf("Contenuto del buffer: %s\n", buffer);

    return 0;
}
```

In questo esempio, l'utente può inserire una stringa di lunghezza 10, ma il programma tenta di copiare questa stringa nel buffer di lunghezza 5. Questo causerà un **buffer overflow**, sovrascrivendo la memoria adiacente al buffer.
:::

### Codice sicuro
:::tip
In Rust, è impossibile scrivere un programma che soffra di buffer overflow grazie ai controlli di sicurezza incorporati nel linguaggio. Tuttavia, in questo esempio ti dimostro come Rust previene i **buffer overflow**:

```rust
use std::io;

fn main() {
    let mut buffer = String::new(); // Dichiarazione di una stringa (buffer) vuota

    println!("Inserisci una stringa: ");
    io::stdin().read_line(&mut buffer).expect("Errore durante la lettura dell'input.");

    // Rust non permette buffer overflow
    // La lunghezza della stringa è controllata automaticamente
    println!("Contenuto del buffer: {}", buffer);
}
```

In questo esempio, Rust utilizza una `String` dinamica invece di un array di caratteri statico. La funzione `read_line` legge l'input dell'utente e lo salva nella variabile `buffer`. Rust gestisce automaticamente la lunghezza della stringa, prevenendo qualsiasi tentativo di buffer overflow. Se l'utente inserisce una stringa più lunga della capacità della variabile `String`, Rust si occuperà automaticamente di espanderla in modo sicuro, prevenendo overflow e garantendo la sicurezza del programma.
:::